# Section 1 : Getting comfortable with Kali linux


## 1 - Finding your way around Kali

### Exercices 

``` 
$ man cat 
$ man -k file compression
$ which pwd 
$ sudo updatedb && locate wce32.exe
``` 

this last one is a bit harder from the others. The goal here is to find the files modified in the last 24-hours (arguments `-mtime 1`), not owned by root (`! -user root`) and execute `ls -l` on the result without chaining & piping (`-exec ls -l {} ';'`). Hence the command :

``` 
$ find -mtime 1 ! -user root -exec ls -l {} ';'
```

## 2 - Managing Kali linux services

### SSH & HTTP services

usual commands :
``` 
  // to start the services
  $ sudo systemctl start ssh/apache2
  
  // to start the services at boot time 
  $ sudo systemctl enable ssh/apache2
  
  // to get the status of a service
  $ sudo ss -antlp | ssh/apache2
  
  $ systemctl list-unit-files
```

## 3 - Command line fun 

### Bash environment 

To inspect the bash history, simply the use of the `$ history` command. And to re-run a specific command : `$ !n` with `n` the number of the command found on the result of the history command. 


### Piping and redirections 

#### general 

Each program run has 3 data streams connected to it : 
+ STDIN : Standard Input
+ STDOUT : Standard Output
+ STDERR : Standard Error 

the use of piping ( | ) and redirection ( > & <) make it possible to redirect the standard streams. 

#### Redirecting to a new file 
to redirect to a new file , use of '>', example :
```
$ echo 'Hello world' > new_file.txt
```

to redirect to an existing file :
```
$ echo "hello World" >> existing_file.txt
```
The second command will write at the end of existing_file.txt.


#### Redirecting from a file 
to redirect from a file, use of '<', example :
``` 
 $ wc -m < redirecting.txt
 ```
 
#### Redirecting the STDERR

to redirect the STDERR output :
``` 
$ ls test 2> file.txt
```
Because 2=STDERR. 
 
#### Piping 

Piping offers the possibility to execute a command with the resulting output of the one that precedes it :
```
$ cat new_file.txt | wc -m 
```
#### Exercices

```
// Question 1 & 2
$ sudo cat /etc/passwd | sort > ./new_file.txt
```

### Text searching and manipulation

#### Grep 

Used also recursively with `-r` and `-i` to ignore text case. 

#### sed

Sed is powerful stream editor. It cat be used on files ou standard outputs. 

Example :
```
$ echo "I need to try hard" | sed 's/hard/harder/'
I need to try harder
```
Here we create a stream with **echo** and pipe it with **sed** to replace the word "hard" with "harder".

#### cut 
**cut** helps splitting a data stream with the keyword **-d** and choosing the field number with **-f**, as a example :
```
$ cut -d ":" -f 1 /etc/passwd
root 
deamon
...
```

#### awk 
**awk** is a programming language designed for text processing. Powerful, but can be extremely complex. 
As an example : 
``` 
$ echo "hello::there::friend"  | awk -F "::" '{print $1, $3}'
hello friend 
``` 

#### exercices

+ question 1
```
kali@kali:~$ cat /etc/passwd | grep /bin/false | awk -F ":" '{print $1, $6}'
mysql /nonexistent
tss /var/lib/tpm
Debian-snmp /var/lib/snmp
lightdm /var/lib/lightdm
```
+ question 2 & 3
```
kali@kali:~$ cat /home/kali/passwd | sed 's/Gnome Display Manager/GDM/'
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
...
```

### Editing files

There many command line editors. **nano, vi , vim** and so on. 

Just to clarify some commands of vi :

+ dd : delete current line
+ yy : copy current line
+ p  : paste clipboard content
+ :w : save 
+ :q! : save without quitting 
+ :wq : save & quit 

### Diff between files

Exercices : 

For the 10.11.1.118 files, we see that main differences is the scan detected the open ports on the second one, but failed to do so on the first one.

For the 10.11.1.234 files, there is 1 port open compared to the other. 

For the 10.11.1.8 files, there is 3 services with open ports in the first file that are not available in the second. These services are, HTTP, HTTPs and MySQL. This proves that there is a server that has been shutdown.
