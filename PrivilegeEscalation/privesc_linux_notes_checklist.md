---
title: Priv esc notes
updated: 2024-01-06 21:15:58Z
created: 2024-01-06 21:14:18Z
---

# Linux priv esc

## checklist
- [ ] Checking if we have credentials if we have DB creds
- [ ] Checking `setuid` files
- [ ] Checking kernel version
- [ ] check into environment variables with `env`
- [ ] If we have docker containers availabe, check if we can inspect the images to retrieve secrets
- [ ] looking for unmounted disks to search for interesting documents, creds or other to privesc or get a foothold in the network
- [ ] checking into dotfiles such as `.bashrc`

https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_-_linux.html
https://zombrax.medium.com/linux-privilege-escalation-e0c3b762c071
https://cheatsheet.haax.fr/web-pentest/resources-discovery/http_request_smuggling/
https://www.youtube.com/watch?v=5NUAsTw_wSA
https://viperone.gitbook.io/pentest-everything/everything/ports/ldap

## Linux Enumeration 

### Key information
#### Get the **username** and **hostname** 
```bash
whoami 
# or 
id
# and for the hostname
hostname
```
#### Listing all the groups a user
```bash
groups
```

#### Obtain a list of all users  
```bash
cat /etc/passwd
```
#### Obtaining a list of all local groups 
```bash
cat /etc/group

```
#### Listing the members of a group 
```bash
cat /etc/group | grep <groupname>
```

#### The OS information can be obtained using 
```bash
cat /etc/issue
# or
cat /etc/os-release
# or 
uname -a 
```
#### Network information 
```bash
ip a
```
#### Checking Routing table 
```bash
routel 
#or 
route
```
#### showing all active connections 
```bash
ss -anlp
```
#### Checking installed applications

```bash
dpkg -l
```


#### Indentifying running processes

```bash
ps aux
```

#### Searching for writable files and directories
```bash
find / -writable -type d 2>/dev/null
find / -writable -type f 2>/dev/null
```
#### Firewall configuration
```bash

cat /etc/iptables/rules.v4
```

#### Crontab and Cron jobs 
```bash
ls -lah /etc/cron*

crontab -l
sudo crontab -l # if weak permissions to see jobs run by root
```
#### Listing mounted filesystems

To list all drives that will be mounted at boot time :
```bash
cat /etc/fstab 
```

To list all mounted filesystems : 
```bash
mount
```

And we can use `lsblk` to view all available disks :
```bash
lsblk
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sda      8:0    0   32G  0 disk
|-sda1   8:1    0   31G  0 part /
|-sda2   8:2    0    1K  0 part
`-sda5   8:5    0  975M  0 part [SWAP]
sr0     11:0    1 1024M  0 rom
```

#### enumerate kernel modules 
to enumerate the loaded modules :
```bash
lsmod
```

If there is an interesting module, we can get details by using modinfo :
```bash
/sbin/modinfo libata
```
It will gives us inetresting information such as the version, description and other to find a exploit. 

#### Setuid and setgid files
represented by an "s" in the file permissions. This allows the current user to execute the file with the rights of the owner (setuid) or the owner's group (setgid). 
So if the SUID permissions are set, the binary will run with the permissions of the file owner. If it's owned by root, any local user will be able to execute that binary with elevated privileges.

to find SID marked binaries :
```bash
find / -perm -u=s -type f 2>/dev/null
```

## Checking databases

### Strings on databases
using `strings` command on databases can be enough sometimes to retrieve information quickly. 

### derby data
