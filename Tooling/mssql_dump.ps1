$database_host = "localhost\SQLEXPRESS"
$database_name = "webapp"
$output_file = "dump_file.data"
$user = "sa"
$password = "WhileChirpTuesday218"

[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SMO') 
$server = new-object "Microsoft.SqlServer.Management.Smo.Server" $database_host 
$server.connectionContext.loginSecure = $false
$server.connectionContext.set_Login($user)
$server.connectionContext.set_Password($password)

$database = $server.Databases[$database_name]
$database.Script() | out-file $output_file

$scripter = new-object "Microsoft.SqlServer.Management.Smo.Scripter" $server
$scripter.options.appendToFile = $false
$scripter.options.scriptData = $true
$scripter.options.includeIfNotExists = $true
$scripter.options.includeHeaders = $true

$scripter.options.indexes = $true
$scripter.options.withDependencies = $true

$scripter.options.toFileOnly = $true
$scripter.options.fileName = $output_file

$tables = $database.tables 

foreach ($s in $scripter.EnumScript($tables)) { write-host $s } 