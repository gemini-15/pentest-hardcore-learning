---
title: Web notes
updated: 2024-01-06 21:14:14Z
created: 2024-01-06 11:29:11Zkal
---

# WEB pentest notesÂ 

## Reminders check-list 
- [ ] Checking for subdomains. 
    - [ ] By fuzzing the `HOST` header
    - [ ] By DNS bruteforcing (If we have an AD we can use the same IP if DNS port is open)
    - [ ] By VHOST enum
- [ ] Directory search with gobuster. 
    - [ ] Search the found tree too
    - [ ] Add extensions (.php, ...)
    - [ ] Fuzzing GET parameters 
- [ ] requesting the `robot.txt` file.
- [ ] check the CMS' versions. 
- [ ] If we have an error page, we can use it to search for the backend frameword or version. 
- [ ] ***When trying for command injection***, we must think of encoding like %20 or base64, or even other bases such as base32 when some characters are not allowed. 


## Enumeration and Info Gathering 


### Subdomain discovery
Subdomain enumeration doesn't work well with `gobuster`. It's more interesting to use `ffuf` [https://github.com/ffuf/ffuf](https://github.com/ffuf/ffuf) sometimes.

- *Refs : [https://sidxparab.gitbook.io/subdomain-enumeration-guide/active-enumeration/dns-bruteforcing](https://sidxparab.gitbook.io/subdomain-enumeration-guide/active-enumeration/dns-bruteforcing)*
- *[https://blog.appsecco.com/a-penetration-testers-guide-to-sub-domain-enumeration-7d842d5570f6](https://blog.appsecco.com/a-penetration-testers-guide-to-sub-domain-enumeration-7d842d5570f6)*

#### Subdomain discovery with DNS bruteforcing

We can gobuster our way to DNS bruteforcing: 
```bash
gobuster dns -d example.com -r <DNS-IP>:53 -w wordlist.txt -t 20 
```
#### subdomain discovery with HOST header
- *notes on ffuf : [https://codingo.io/tools/ffuf/bounty/2020/09/17/everything-you-need-to-know-about-ffuf.html](https://codingo.io/tools/ffuf/bounty/2020/09/17/everything-you-need-to-know-about-ffuf.html)*

Example usage of DNS enum with a 200 response filter :
```bash
ffuf -w wordlist.txt -u http:/domain.go/ -H "Host: FUZZ.domain.go" -mc 200
```

The usage with gobuster could be the following :
```bash
gobuster dns -d http://domain.go/ -w wordlist.txt -r resolverIP
```

### Directory search 

#### Simple directory search
```bash
gobuster dir -u http://internal.analysis.htb/ -w ~/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 100 
```
#### Directory search with language extension 
```bash
gobuster dir -u http://internal.analysis.htb/dashboard/ -w ~/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 100 --add-slash -x php
```
#### Fuzzing get parameters
```bash
gobuster fuzz -u "http://internal.analysis.htb/users/list.php?FUZZ=admin" -w ~/SecLists/Discovery/Web-Content/burp-parameter-names.txt --exclude-length 17  
```
## Web frameworks and tips
- *Spring Boot* : [https://blog.certcube.com/spring-boot-pentesting-fundamentals-part-1/](https://blog.certcube.com/spring-boot-pentesting-fundamentals-part-1/)

### ASP.NET
#### Exploiting deserialization in asp.net via viewstate
ViewState is used to maintain a page state and persist data in a web form. 

The viewstate parameter is a base64 serialised sent via a parameter called `_VIEWSTATE` with a POST req.

This parameter is deserialized on the server-side to retreive the data. 

**This exploitation technique is for enabled MAC Viewstate validation :** The knowledge of used validation and decryption keys and algorithms within the `machineKey`section of the configuration files present at `web.config` or `machine.config`, is required. Default validation algorithm is `HMACSHA256` and `AES` for the decrytion algorithm. 

#### ysoserial.net to create ViewState payloads

The prerequisites are : MAC validation enabled and we know the secrets. 







*refs:*
- [https://soroush.me/blog/2019/04/exploiting-deserialisation-in-asp-net-via-viewstate/](https://soroush.me/blog/2019/04/exploiting-deserialisation-in-asp-net-via-viewstate/)
- [https://github.com/pwntester/ysoserial.net](https://github.com/pwntester/ysoserial.net)
- [https://learn.microsoft.com/en-us/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis](https://learn.microsoft.com/en-us/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis)

## Command injection tricks and payloads

```
# cozyhosting HTB example
host=10.10.14.160&username=;echo${IFS}"[PAYLOAD]"|base32${IFS}-d|bash;
```