---
title: AD cheat-sheet
updated: 2023-11-05 21:59:06Z
created: 2023-11-05 21:57:58Z
---

## Powershell cheat-sheet
- ***to retrieve information about an AD user :*** `get-ADuser` 
-  ***to retrieve information about a service account :*** `get-ADserviceaccount`
	- adding `-properties *` to get all the informations about the account.
	-  for [GMSA](https://www.dsinternals.com/en/retrieving-cleartext-gmsa-passwords-from-active-directory/)
-  ***Credential to usable variable in Powershell :*** 
	-  The password could be a `System.Security.SecureString` object (if not it must be converted).
```powershell 
	$cred = New-Object System.Management.Automation.PScredential "username",$secpwd
```
- Send a command when we can't have a direct access :
```powershell
Invoke-Command -ComputerName 127.0.0.1 -cred $cred -SCriptBlock { whoami }
```

## Powerview cheat-sheet

### Information gathering in a Domain 

#### Retrieving the list of groups 

#### Retrieving the list of users

#### Retrieving the list Operating systems 
```powershell
Get-NetComputer
```

#### Determine admin permissions of user in a domain
To see if our user has any administrative permissions on any computer in the domain we can use `Find-LocalAdminAccess` from ***PowerView***. 

> What does the function do? 
> The powerview command uses `OpenServiceW` function that connects to the Service Control Manager (SCM) (maintains a DB with SC_MANAGER_ALL_ACCESS which requires admin privs). If the connection is a success => our user has admin privs on that machine. 

```powershell
Find-LocalAdminAccess
```

## Sysinternals tools cheat-sheet 
