---
title: AD cheat-sheet
updated: 2023-11-05 21:59:06Z
created: 2023-11-05 21:57:58Z
---

## Powershell cheat-sheet
- ***to retrieve information about an AD user :*** `get-ADuser` 
-  ***to retrieve information about a service account :*** `get-ADserviceaccount`
	- adding `-properties *` to get all the informations about the account.
	-  for [GMSA](https://www.dsinternals.com/en/retrieving-cleartext-gmsa-passwords-from-active-directory/)
-  ***Credential to usable variable in Powershell :*** 
	-  The password could be a `System.Security.SecureString` object (if not it must be converted).
```powershell 
	$cred = New-Object System.Management.Automation.PScredential "username",$secpwd
```
- Send a command when we can't have a direct access :
```powershell
Invoke-Command -ComputerName 127.0.0.1 -cred $cred -SCriptBlock { whoami }
```

## Cracking passwords cheat-sheet